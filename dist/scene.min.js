(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("pixi.js")):"function"==typeof define&&define.amd?define(["exports","pixi.js"],b):(a=a||self,b(a.SceneKit={},a.PIXI))})(this,function(a,b){'use strict';/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */ /* global Reflect, Promise */function c(a,c){function b(){this.constructor=a}e(a,c),a.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}/**
     * @class
     * @property { Bumber } x - 世界坐标 `x` 值
     * @property { Bumber } y - 世界坐标 `y` 值
     */var e=function(a,c){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var b in c)c.hasOwnProperty(b)&&(a[b]=c[b])},e(a,c)},f=/** @class */function(a){function b(b){var c=a.call(this)||this;return c.init(),c.scene=b,c.isWorld=!0,c}return c(b,a),b.prototype.init=function(){this.x=0,this.y=0},b.prototype.onSceneChange=function(){this.init()},b.prototype.shutdown=function(){this.removeChildren()},b}(b.Container),g=function(a,b){return b={exports:{}},a(b,b.exports),b.exports}(function(a){/* Web Font Loader v1.6.28 - (c) Adobe Systems, Google. License: Apache 2.0 */(function(){function b(b){return b.call.apply(b.bind,arguments)}function c(e,a){if(!e)throw Error();if(2<arguments.length){var b=Array.prototype.slice.call(arguments,2);return function(){var d=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(d,b),e.apply(a,d)}}return function(){return e.apply(a,arguments)}}function d(){return d=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?b:c,d.apply(null,arguments)}function e(c,a){this.a=c,this.o=a||c,this.c=this.o.document}function h(f,a,g,c){if(a=f.c.createElement(a),g)for(var d in g)g.hasOwnProperty(d)&&("style"==d?a.style.cssText=g[d]:a.setAttribute(d,g[d]));return c&&a.appendChild(f.c.createTextNode(c)),a}function i(d,e,b){d=d.c.getElementsByTagName(e)[0],d||(d=document.documentElement),d.insertBefore(b,d.lastChild)}function f(b){b.parentNode&&b.parentNode.removeChild(b)}function g(h,a,i){a=a||[],i=i||[];for(var j=h.className.split(/\s+/),d=0;d<a.length;d+=1){for(var k=!1,l=0;l<j.length;l+=1)if(a[d]===j[l]){k=!0;break}k||j.push(a[d])}for(a=[],d=0;d<j.length;d+=1){for(k=!1,l=0;l<i.length;l+=1)if(j[d]===i[l]){k=!0;break}k||a.push(j[d])}h.className=a.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function j(f,a){for(var b=f.className.split(/\s+/),c=0,g=b.length;c<g;c++)if(b[c]==a)return!0;return!1}function k(b){return b.o.location.hostname||b.a.location.hostname}function l(j,a,k){function c(){n&&d&&l&&(n(f),n=null)}a=h(j,"link",{rel:"stylesheet",href:a,media:"all"});var d=!1,l=!0,f=null,n=k||null;q?(a.onload=function(){d=!0,c()},a.onerror=function(){d=!0,f=Error("Stylesheet failed to load"),c()}):setTimeout(function(){d=!0,c()},0),i(j,"head",a)}function m(i,a,b,c){var d=i.c.getElementsByTagName("head")[0];if(d){var e=h(i,"script",{src:a}),f=!1;return e.onload=e.onreadystatechange=function(){f||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(f=!0,b&&b(null),e.onload=e.onreadystatechange=null,"HEAD"==e.parentNode.tagName&&d.removeChild(e))},d.appendChild(e),setTimeout(function(){f||(f=!0,b&&b(Error("Script load timeout")))},c||5E3),e}return null}function n(){this.a=0,this.c=null}function o(b){return b.a++,function(){b.a--,s(b)}}function r(c,a){c.c=a,s(c)}function s(b){0==b.a&&b.c&&(b.c(),b.c=null)}function t(b){this.a=b||"-"}function u(d,a){this.c=d,this.f=4,this.a="n";var b=(a||"n4").match(/^([nio])([1-9])$/i);b&&(this.a=b[1],this.f=parseInt(b[2],10))}function v(b){return x(b)+" "+(b.f+"00 300px ")+w(b.c)}function w(e){var f=[];e=e.split(/,\s*/);for(var b,g=0;g<e.length;g++)b=e[g].replace(/['"]/g,""),-1!=b.indexOf(" ")||/^\d/.test(b)?f.push("'"+b+"'"):f.push(b);return f.join(",")}function y(b){return b.a+b.f}function x(c){var a="normal";return"o"===c.a?a="oblique":"i"===c.a&&(a="italic"),a}function z(e){var a=4,f="n",g=null;return e&&((g=e.match(/(normal|oblique|italic)/i))&&g[1]&&(f=g[1].substr(0,1).toLowerCase()),(g=e.match(/([1-9]00|normal|bold)/i))&&g[1]&&(/bold/i.test(g[1])?a=7:/[1-9]00/.test(g[1])&&(a=parseInt(g[1].substr(0,1),10)))),f+a}function A(c,a){this.c=c,this.f=c.o.document.documentElement,this.h=a,this.a=new t("-"),this.j=!1!==a.events,this.g=!1!==a.classes}function B(b){b.g&&g(b.f,[b.a.c("wf","loading")]),D(b,"loading")}function C(e){if(e.g){var a=j(e.f,e.a.c("wf","active")),b=[],c=[e.a.c("wf","loading")];a||b.push(e.a.c("wf","inactive")),g(e.f,b,c)}D(e,"inactive")}function D(d,a,b){d.j&&d.h[a]&&(b?d.h[a](b.c,y(b)):d.h[a]())}function E(){this.c={}}function F(g,a,b){var c,h=[];for(c in a)if(a.hasOwnProperty(c)){var d=g.c[c];d&&h.push(d(a[c],b))}return h}function G(c,a){this.c=c,this.f=a,this.a=h(this.c,"span",{"aria-hidden":"true"},this.f)}function H(b){i(b.c,"body",b.a)}function I(b){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+w(b.c)+";"+("font-style:"+x(b)+";font-weight:"+(b.f+"00;"))}function J(g,a,b,c,d,e){this.g=g,this.j=a,this.a=c,this.c=b,this.f=d||3E3,this.h=e||void 0}function K(h,i,b,c,d,e,f){this.v=h,this.B=i,this.c=b,this.a=c,this.s=f||"BESbswy",this.f={},this.w=d||3E3,this.u=e||null,this.m=this.j=this.h=this.g=null,this.g=new G(this.c,this.s),this.h=new G(this.c,this.s),this.j=new G(this.c,this.s),this.m=new G(this.c,this.s),h=new u(this.a.c+",serif",y(this.a)),h=I(h),this.g.a.style.cssText=h,h=new u(this.a.c+",sans-serif",y(this.a)),h=I(h),this.h.a.style.cssText=h,h=new u("serif",y(this.a)),h=I(h),this.j.a.style.cssText=h,h=new u("sans-serif",y(this.a)),h=I(h),this.m.a.style.cssText=h,H(this.g),H(this.h),H(this.j),H(this.m)}function L(){if(null===R){var b=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);R=!!b&&(536>parseInt(b[1],10)||536===parseInt(b[1],10)&&11>=parseInt(b[2],10))}return R}function M(e,a,b){for(var c in da)if(da.hasOwnProperty(c)&&a===e.f[da[c]]&&b===e.f[da[c]])return!0;return!1}function N(e){var a,f=e.g.a.offsetWidth,b=e.h.a.offsetWidth;(a=f===e.f.serif&&b===e.f["sans-serif"])||(a=L()&&M(e,f,b)),a?ja()-e.A>=e.w?L()&&M(e,f,b)&&(null===e.u||e.u.hasOwnProperty(e.a.c))?P(e,e.v):P(e,e.B):O(e):P(e,e.v)}function O(b){setTimeout(d(function(){N(this)},b),50)}function P(c,a){setTimeout(d(function(){f(this.g.a),f(this.h.a),f(this.j.a),f(this.m.a),a(this.a)},c),0)}function Q(d,a,b){this.c=d,this.a=a,this.f=0,this.m=this.j=!1,this.s=b}function T(b){0==--b.f&&b.j&&(b.m?(b=b.a,b.g&&g(b.f,[b.a.c("wf","active")],[b.a.c("wf","loading"),b.a.c("wf","inactive")]),D(b,"active")):C(b.a))}function U(b){this.j=b,this.a=new E,this.h=0,this.f=this.g=!0}function V(h,a,b,c,i){var e=0==--h.h;(h.f||h.g)&&setTimeout(function(){var f=c||null||{};if(0===b.length&&e)C(a.a);else{a.f+=b.length,e&&(a.j=e);var j,m=[];for(j=0;j<b.length;j++){var l=b[j],k=f[l.c],n=a.a,o=l;if(n.g&&g(n.f,[n.a.c("wf",o.c,y(o).toString(),"loading")]),D(n,"fontloading",o),n=null,null===ka)if(window.FontFace){var o=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),p=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);ka=o?42<parseInt(o[1],10):!p}else ka=!1;n=ka?new J(d(a.g,a),d(a.h,a),a.c,l,a.s,k):new K(d(a.g,a),d(a.h,a),a.c,l,a.s,i||null,k),m.push(n)}for(j=0;j<m.length;j++)m[j].start()}},0)}function W(g,a,h){var i=[],j=h.timeout;B(a);var i=F(g.a,h,g.c),e=new Q(g.c,a,j);for(g.h=i.length,a=0,h=i.length;a<h;a++)i[a].load(function(a,b,d){V(g,e,a,b,d)})}function $(c,a){this.c=c,this.a=a}function _(c,a){this.c=c,this.a=a}function aa(c,a){this.c=c?c:la,this.a=[],this.f=[],this.g=a||""}function ba(g,a){for(var b,h=a.length,c=0;c<h;c++){b=a[c].split(":"),3==b.length&&g.f.push(b.pop());var i="";2==b.length&&""!=b[1]&&(i=":"),g.a.push(b.join(i))}}function ca(e){if(0==e.a.length)throw Error("No fonts to load!");if(-1!=e.c.indexOf("kit="))return e.c;for(var a=e.a.length,f=[],c=0;c<a;c++)f.push(e.a[c].replace(/ /g,"+"));return a=e.c+"?family="+f.join("%7C"),0<e.f.length&&(a+="&subset="+e.f.join(",")),0<e.g.length&&(a+="&text="+encodeURIComponent(e.g)),a}function ea(b){this.f=b,this.a=[],this.c={}}function fa(i){for(var a=i.f.length,b=0;b<a;b++){var j=i.f[b].split(":"),o=j[0].replace(/\+/g," "),e=["n4"];if(2<=j.length){var p,q=j[1];if(p=[],q)for(var q=q.split(","),s=q.length,h=0;h<s;h++){var t;if(t=q[h],t.match(/^[\w-]+$/)){var v=pa.exec(t.toLowerCase());if(null==v)t="";else{if(t=v[2],t=null==t||""==t?"n":oa[t],v=v[1],null==v||""==v)v="4";else var w=na[v],v=w?w:isNaN(v)?"4":v.substr(0,1);t=[t,v].join("")}}else t="";t&&p.push(t)}0<p.length&&(e=p),3==j.length&&(j=j[2],p=[],j=j?j.split(","):p,0<j.length&&(j=ma[j[0]])&&(i.c[o]=j))}for(i.c[o]||(j=ma[o])&&(i.c[o]=j),j=0;j<e.length;j+=1)i.a.push(new u(o,e[j]))}}function ga(c,a){this.c=c,this.a=a}function ha(c,a){this.c=c,this.a=a}function ia(c,a){this.c=c,this.f=a,this.a=[]}var ja=Date.now||function(){return+new Date},q=!!window.FontFace;t.prototype.c=function(){for(var a=[],b=0;b<arguments.length;b++)a.push(arguments[b].replace(/[\W_]+/g,"").toLowerCase());return a.join(this.a)},J.prototype.start=function(){var g=this.c.o.document,h=this,a=ja(),b=new Promise(function(b,c){function d(){ja()-a>=h.f?c():g.fonts.load(v(h.a),h.h).then(function(c){1<=c.length?b():setTimeout(d,25)},function(){c()})}d()}),c=null,d=new Promise(function(b,a){c=setTimeout(a,h.f)});Promise.race([d,b]).then(function(){c&&(clearTimeout(c),c=null),h.g(h.a)},function(){h.j(h.a)})};var da={D:"serif",C:"sans-serif"},R=null;K.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=ja(),N(this)};var ka=null;Q.prototype.g=function(c){var a=this.a;a.g&&g(a.f,[a.a.c("wf",c.c,y(c).toString(),"active")],[a.a.c("wf",c.c,y(c).toString(),"loading"),a.a.c("wf",c.c,y(c).toString(),"inactive")]),D(a,"fontactive",c),this.m=!0,T(this)},Q.prototype.h=function(f){var a=this.a;if(a.g){var b=j(a.f,a.a.c("wf",f.c,y(f).toString(),"active")),c=[],d=[a.a.c("wf",f.c,y(f).toString(),"loading")];b||c.push(a.a.c("wf",f.c,y(f).toString(),"inactive")),g(a.f,c,d)}D(a,"fontinactive",f),T(this)},U.prototype.load=function(b){this.c=new e(this.j,b.context||this.j),this.g=!1!==b.events,this.f=!1!==b.classes,W(this,new A(this.c,b),b)},$.prototype.load=function(g){function a(){if(d["__mti_fntLst"+i]){var b,f=d["__mti_fntLst"+i](),c=[];if(f)for(var e,j=0;j<f.length;j++)e=f[j].fontfamily,null!=f[j].fontStyle&&null!=f[j].fontWeight?(b=f[j].fontStyle+f[j].fontWeight,c.push(new u(e,b))):c.push(new u(e));g(c)}else setTimeout(function(){a()},50)}var b=this,i=b.a.projectId,c=b.a.version;if(i){var d=b.c.o;m(this.c,(b.a.api||"https://fast.fonts.net/jsapi")+"/"+i+".js"+(c?"?v="+c:""),function(c){c?g([]):(d["__MonotypeConfiguration__"+i]=function(){return b.a},a())}).id="__MonotypeAPIScript__"+i}else g([])},_.prototype.load=function(i){var a,j,k=this.a.urls||[],p=this.a.families||[],e=this.a.testStrings||{},f=new n;for(a=0,j=k.length;a<j;a++)l(this.c,k[a],o(f));var g=[];for(a=0,j=p.length;a<j;a++)if(k=p[a].split(":"),k[1])for(var m=k[1].split(","),h=0;h<m.length;h+=1)g.push(new u(k[0],m[h]));else g.push(new u(k[0]));r(f,function(){i(g,e)})};var la="https://fonts.googleapis.com/css",ma={latin:"BESbswy","latin-ext":"\xE7\xF6\xFC\u011F\u015F",cyrillic:"\u0439\u044F\u0416",greek:"\u03B1\u03B2\u03A3",khmer:"\u1780\u1781\u1782",Hanuman:"\u1780\u1781\u1782"},na={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},oa={i:"i",italic:"i",n:"n",normal:"n"},pa=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/,qa={Arimo:!0,Cousine:!0,Tinos:!0};ga.prototype.load=function(g){var a=new n,b=this.c,c=new aa(this.a.api,this.a.text),d=this.a.families;ba(c,d);var e=new ea(d);fa(e),l(b,ca(c),o(a)),r(a,function(){g(e.a,e.c,qa)})},ha.prototype.load=function(d){var a=this.a.id,i=this.c.o;a?m(this.c,(this.a.api||"https://use.typekit.net")+"/"+a+".js",function(a){if(a)d([]);else if(i.Typekit&&i.Typekit.config&&i.Typekit.config.fn){a=i.Typekit.config.fn;for(var c=[],e=0;e<a.length;e+=2)for(var j=a[e],g=a[e+1],k=0;k<g.length;k++)c.push(new u(j,g[k]));try{i.Typekit.load({events:!1,classes:!1,async:!0})}catch(a){}d(c)}},2E3):d([])},ia.prototype.load=function(e){var a=this.f.id,b=this.c.o,f=this;a?(b.__webfontfontdeckmodule__||(b.__webfontfontdeckmodule__={}),b.__webfontfontdeckmodule__[a]=function(a,b){for(var c,d=0,i=b.fonts.length;d<i;++d)c=b.fonts[d],f.a.push(new u(c.name,z("font-weight:"+c.weight+";font-style:"+c.style)));e(f.a)},m(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+k(this.c)+"/"+a+".js",function(a){a&&e([])})):e([])};var ra=new U(window);ra.a.c.custom=function(c,a){return new _(a,c)},ra.a.c.fontdeck=function(c,a){return new ia(a,c)},ra.a.c.monotype=function(c,a){return new $(a,c)},ra.a.c.typekit=function(c,a){return new ha(a,c)},ra.a.c.google=function(c,a){return new ga(a,c)};var Y={load:d(ra.load,ra)};a.exports?a.exports=Y:(window.WebFont=Y,window.WebFontConfig&&ra.load(window.WebFontConfig))})()}),h="undefined"!=typeof wx,i=/** @class */function(){function a(){}return a.onLoaded=function(a){void 0===a&&(a=function(){}),this._onLoaded=a},a.Load=function(a){var b=this;if(h)return a.map(function(a){wx.loadFont(a)});var c=a.map(function(a){var b=a.lastIndexOf("."),c=a.lastIndexOf("/");return a.slice(c+1,b)}).filter(function(a){return!!a});return g.load({custom:{families:c},active:function(){return b._onLoaded()}}),[""]},a._onLoaded=function(){},a}(),j=/** @class */function(){function a(b){this.name=b,this.canUpdate=!1,this.world=new f(this),this.game=a.game,this.route=a.route,this.route.push(this)}return Object.defineProperty(a.prototype,"Loader",{get:function(){var a={count:0,needLoadFont:!1};return{add:function(){for(var a,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];b.Loader.shared.resources[c[0]]||(a=b.Loader.shared).add.apply(a,c)},Load:function(a){var b=this;Object.keys(a).map(function(c){return b.add(c,a[c])})},LoadFont:function(b){a.needLoadFont=!0,i.Load(b)},onLoaded:function(c){void 0===c&&(c=function(){});var d=function(){a.count++,2===a.count&&c()};b.Loader.shared.load(function(){return a.needLoadFont?d():c()}),i.onLoaded(function(){return d()})}}},enumerable:!0,configurable:!0}),a.prototype.Load=function(){return this.resourcesGetter.reduce(function(a,b){return a=Object.assign(a,b()),a},{})},a.prototype.useLoad=function(a){this.resourcesGetter.push(a)},a.prototype.switchTo=function(a,b){void 0===b&&(b={}),this.route.to(a,b)},a.prototype.getQuery=function(a){return a?this.route.query[a]:this.route.query},a.prototype.create=function(){this.canUpdate=!0},a.prototype.update=function(){if(!this.canUpdate)return!1},a.prototype.shutdown=function(a){void 0===a&&(a=!0),this.canUpdate=!1,a&&this.world.shutdown()},a}(),k=/** @class */function(){function a(a){this.game=a,this.scenes={},this.query={},this.prevSceneName=null,this.currentSceneName=null,this.pendingSceneName=null,this.currentScene=null,this.instance=null}/**
         * 把场景保存在 `this.scenes` 中
         * @param { Scene } scene - 场景实例
         * @ignore
         */return a.prototype.push=function(a){this.scenes[a.name]=a},a.prototype.remove=function(a){"string"==typeof a?delete this.scenes[a]:a instanceof j?delete this.scenes[a.name]:console.warn("\u9700\u8981\u79FB\u9664\u7684\u573A\u666F "+a+" \u4E0D\u5B58\u5728")},a.prototype.start=function(a,b){void 0===a&&(a=""),void 0===b&&(b={}),this.to(a,b)},a.prototype.to=function(a,b){return this.currentSceneName!==a&&void(this.isScene(a)&&(this.pendingSceneName=a,this.query=b))},a.prototype.update=function(){this.pendingSceneName&&this.setCurrentScene(this.pendingSceneName),this.currentScene&&this.currentScene.canUpdate&&this.currentScene.update&&this.currentScene.update()},a.prototype.setCurrentScene=function(a){return this.isScene(a)?void(this.currentSceneName!==this.pendingSceneName&&(this.currentScene=this.scenes[a],this.setGameWorld(),this.cleanStage(),this.fetchNextScene(),this.stateUpdate(),this.onSceneChange())):(console.warn("\u573A\u666F "+a+" \u4E0D\u5B58\u5728"),!1)},a.prototype.setGameWorld=function(){this.game.world=this.currentScene.world},a.prototype.cleanStage=function(){this.game.stage.removeChildren()},a.prototype.fetchNextScene=function(){var a=this;this.game.stage.addChild(this.currentScene.world),this.currentScene.Load&&"function"==typeof this.currentScene.Load?this.currentScene.Load(function(){a.currentScene.create()}):this.currentScene.create(),this.pendingSceneName=null},a.prototype.stateUpdate=function(){this.prevSceneName=this.currentSceneName,this.currentSceneName=this.currentScene.name},a.prototype.onSceneChange=function(){if(this.prevSceneName){var a=this.scenes[this.prevSceneName];a.shutdown(),this.game.stage.removeChild(a.world)}this.currentScene.world.onSceneChange()},a.prototype.getCurrentScene=function(){return this.currentScene},a.prototype.getSceneByName=function(a){return this.scenes[a]?this.scenes[a]:void console.error("\u573A\u666F "+a+" \u4E0D\u5B58\u5728")},a.prototype.isScene=function(a){void 0===a&&(a="");var b=void 0!==this.scenes[a];return b},a.prototype.destroy=function(){this.game=null,this.scenes={},this.pendingSceneName=null,this.currentSceneName=null,this.currentScene=null},a}();a.Scene=j,a.useScene=function(a,b){var c=new k(a),d=Object.keys(b),e=Object.values(b);e.map(function(b,e){b.__proto__.game=a,b.__proto__.route=c,new b(d[e])}),c.start(d[0]),a.ticker.add(function(){return c.update()})},Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=scene.min.js.map
